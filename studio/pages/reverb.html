<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waveform with Reverb</title>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <style>
        #waveform {
            width: 100%;
            height: 200px;
        }

        #controls {
            margin-top: 20px;
        }

        #reverb-slider {
            width: 300px;
            margin: 10px 0;
        }
    </style>
</head>

<body>
    <div id="waveform"></div>
    <div id="controls">
        <button id="loadButton">LoadReal</button>
        <button id="applyReverbButton">Apply</button>

        <button id="load">Load</button>
        <button id="play-button">Play</button>
        <button id="stop-button">Stop</button>
        <div>
            <label for="reverb-slider">Reverb:</label>
            <div id="reverb-slider"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/6.6.3/wavesurfer.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <!-- <script type="module" data-type="module" src="scripts/effectReverb.js"></script> -->
    <script>
        // Variables
        let audio;
        let reverb;

        // Event listener for Load button
        document.getElementById('loadButton').addEventListener('click', async () => {
            // Assuming uploadedAudioURL is defined somewhere in your code
            const uploadedAudioURL = '../outputs/audioID=667da1dadec755.48318760/vocals.mp3';

            // Create Audio element
            audio = new Audio(uploadedAudioURL);
            audio.controls = true;

            // Append audio element to the body
            document.body.appendChild(audio);

            // Initialize Tone.js and reverb effect
            await Tone.start();  // Start Tone.js context
            // reverb = new Tone.Reverb().toDestination();  // Create reverb effect
            delay = new Tone.FeedbackDelay(0.5, 0.1).toDestination();
            const mediaElementSource = Tone.context.createMediaElementSource(audio);
            // Tone.connect(mediaElementSource, reverb);
            Tone.connect(mediaElementSource, delay);
        });

    </script>
</body>

</html>